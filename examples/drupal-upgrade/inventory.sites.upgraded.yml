---
# Version Groups
# User-defined.
# Allows controlling an App Host's version by putting it in this group.
composertemplate:
  children:
    version9:
      hosts:
        d7.local.computer:
        d8.local.computer:
        d9.local.computer:

# This group tells the d8 and d7 sites to clear out their vendor code and prep for major upgrade.

# Override the default build command coming from the drupal app group.
# After git checkout from old drupal, the vendor directories must be reinstalled.
# The CHMOD is needed because drush site install removes write perms and the
# drupal 7 sites need to get it's first default.*.yml files.
upgrade_from_7:
  hosts:
    d7.local.computer:
  vars:
    devshop_app_command_build: |
      rm -rf composer.lock vendor web/core web/modules/contrib web/themes/contrib web/libraries
      chmod +w web/sites/default
      composer install
      chmod -w web/sites/default

upgrade_from_8:
  hosts:
    d8.local.computer:
  vars:
    devshop_app_command_build: |
      rm -rf composer.lock vendor web/core web/modules/contrib web/themes/contrib web/libraries
      composer install
